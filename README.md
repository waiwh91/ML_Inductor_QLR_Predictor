# ML Inductor QLR Predictor
***
*This Repo is the outcome of an ongoing Master Degree's research project in EEE at UCC, in collaboration with Tyndall National Institute*

## *Accuracy*
With the following parameter:  
Trainer: `epochs = 2000, alpha = 1.0, beta = 6.0`  
Data_splitter: `proportion = 0.7`  
The lowest MPE tested on the test dataset is:  
* ***R: 1%***  
* ***L: 0.95%***  
* ***Q: 2.7%***

## Data processing
Data_processor will automatically read filenames and data, then generate `data.csv` in root folder. 
Data frame of `data.csv`:  

|tCu|wCu|tLamCore|Nlam|tAlN|tSu8|Freq|Q|R|L|
|---|---|---|---|---|---|---|---|---|---|

### Parameter Generator
`paramter_generator.py` generates random design parameters for the simulator, to create more data for both raining and testing.  
The design parameter range and data amount can be set in the file.  
The output file is located in `ML_Inductor_QLR_Predictor/simulation_test`, with `simulation_data.csv` contains 5 frequency foints, and `output_nofreq.csv` contains only design parameters.

## Machine Learning Model

### PINN Model
The model contains 3 hHidden Layers, 2 Layer Normalization, with 7 inputs and 2 outputs.  
The activation function is `Tanh()`.  
Here's the sequence of the model.  
`[Input 6(without freq)] -> [H1, 32 nodes] -> Layer Normalization -> [add freq data] -> [H2, 16 nodes] -> Layer Normalization -> [H3, 8 nodes] -> [Output 2]`

### Training Parameters:
The model introduced physical information to improve the accuracy of prediction.  
Total `loss` is based on 2 parts, MSE of prediction, and MSE of Q.  
Q is calculated from the equation:  
*Q = 2 pi * f * L / R*
* `alpha`: coefficient of Prediction MSE, default = 1.0
* `beta` : coefficient of Q MSE, default = 6.0

### Data splitter
Split the data into Training set and Testing set. For small data set, the proportion of Training set should be larger (90%). For a normal size data set, the proportion of Training set is 70% by default. 

## Run the project
*Needed Python Libraries:  Torch, Numpy, Pandas*

### Data processing and Training

Put all `.csv` data generated by the simulator in `ML_Inductor_QLR_Predictor/RLQ`  
Run `ML_Inductor_QLR_Predictor/main.py`  
The model is saved at `ML_Inductor_QLR_Predictor/models/PINN_model.pth`  
Console output: MPE of the Test data set. (Compared with the simulation data)  
File output: `output.csv`  
Data frame:  

| R_pre | L_pre | Q_Pre| R_data | L_data | Q_data | Freq |
|---|---|---|---|---|---|---|

### Simulation test

Run `tester.py`, the program will read `ML_Inductor_QLR_Predictor/simulation_test/simulation_data.csv`, then generate the predicted data `predicted_output.csv` in the same folder.  
Run the simulator with the same data, then compare the simulator output with the predicted data.
